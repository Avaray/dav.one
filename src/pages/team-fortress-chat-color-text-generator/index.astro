---
import Head from '@components/Head.astro';
import './_styles.css';
import { COLOR_PALETTES } from './colorizer.js';

const title = 'TF2 Chat Colorizer';
const description = 'Generate colored text for Team Fortress 2 chat.';
---

<!doctype html>
<html lang='en'>
  <Head title={title} description={description} ignoreGlobalStyles />
  <body class='bg-slate-950 text-slate-200 min-h-screen font-sans selection:bg-orange-500/30'>
    <main class='max-w-6xl mx-auto px-6 py-12'>
      <header class='mb-8 text-center border-b border-slate-800 pb-8'>
        <h1 class='text-5xl font-black text-orange-500 mb-3 tracking-tighter uppercase drop-shadow-lg font-mono'>
          TF2 Chat Colorizer
        </h1>
        <p class='text-slate-400 max-w-lg mx-auto'>
          Create colored messages for the Source Engine.<br />
          Works in <span class='text-white font-bold'>Team Chat</span> and <span class='text-white font-bold'
            >Dead Chat</span
          >.
        </p>
      </header>

      <div class='grid lg:grid-cols-12 gap-8'>
        {/* Editor */}
        <div class='lg:col-span-8 space-y-6'>
          <div class='bg-slate-900 border border-slate-800 rounded-xl p-1 shadow-2xl relative overflow-hidden group'>
            <div class='absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-orange-600 to-yellow-500 opacity-50'>
            </div>

            <div class='p-5'>
              <div class='flex justify-between items-center mb-3'>
                <label class='font-bold text-xs uppercase tracking-widest text-slate-500'>Message Editor</label>
                <span id='char-count' class='text-xs font-mono text-slate-500'>0 / 127 bytes</span>
              </div>

              <textarea
                id='input-text'
                rows='5'
                class='w-full bg-slate-950 border border-slate-700 rounded-lg p-4 text-lg font-mono focus:outline-none focus:border-orange-500 focus:ring-1 focus:ring-orange-500 transition-all placeholder:text-slate-700 resize-none leading-relaxed'
                placeholder='Type your message here...'></textarea>

              <div class='flex items-center gap-3 mt-4'>
                <div
                  class='relative flex items-center gap-2 bg-slate-800 rounded-lg px-3 py-1.5 border border-slate-700 hover:border-slate-500 transition-colors'
                >
                  <input
                    type='color'
                    id='custom-color'
                    class='w-6 h-6 rounded cursor-pointer bg-transparent border-0 p-0'
                    value='#ffffff'
                  />
                  <span class='text-xs font-mono text-slate-400 uppercase'>Picker</span>
                </div>

                <button
                  id='btn-reset-tag'
                  class='px-3 py-1.5 rounded-lg text-xs font-bold bg-red-950/30 text-red-400 border border-red-900/50 hover:bg-red-900/50 hover:text-red-200 transition-colors ml-auto'
                >
                  &#123;reset&#125;
                </button>
              </div>
            </div>
          </div>

          <div class='bg-slate-900 border border-slate-800 rounded-xl p-6 shadow-xl'>
            <label class='font-bold text-xs uppercase tracking-widest text-slate-500 mb-3 block'>Preview</label>
            <div
              id='preview-box'
              class='min-h-[3.5rem] bg-[#2b2826] border-l-4 border-orange-500/50 rounded-r-lg p-4 font-bold font-mono text-xl mb-6 break-words whitespace-pre-wrap shadow-inner text-slate-200'
            >
            </div>

            <button
              id='copy-btn'
              class='w-full py-4 bg-gradient-to-r from-orange-700 to-orange-600 hover:from-orange-600 hover:to-orange-500 text-white font-bold text-lg rounded-lg shadow-lg hover:shadow-orange-500/20 active:scale-[0.99] transition-all flex items-center justify-center gap-3 uppercase tracking-wide'
            >
              <span>Copy to Clipboard</span>
              <svg
                xmlns='http://www.w3.org/2000/svg'
                class='h-6 w-6'
                fill='none'
                viewBox='0 0 24 24'
                stroke='currentColor'
                ><path
                  stroke-linecap='round'
                  stroke-linejoin='round'
                  stroke-width='2'
                  d='M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3'
                ></path></svg
              >
            </button>
            <p
              id='copy-feedback'
              class='text-green-400 text-center text-sm mt-3 font-mono opacity-0 transition-opacity duration-300'
            >
              Copied!
            </p>
          </div>
        </div>

        {/* Palette */}
        <aside class='lg:col-span-4 space-y-6'>
          <div class='sticky top-6'>
            <h2 class='text-lg font-bold text-slate-300 mb-4 px-2'>Color Palette</h2>
            <div class='space-y-6 pr-2 max-h-[80vh] overflow-y-auto custom-scrollbar'>
              {
                Object.entries(COLOR_PALETTES).map(([category, colors]) => (
                  <div class='bg-slate-900 border border-slate-800 rounded-xl p-4'>
                    <h3 class='text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 border-b border-slate-800/50 pb-2'>
                      {category}
                    </h3>
                    <div class='grid grid-cols-1 gap-1.5'>
                      {colors.map((color) => (
                        <button
                          class='js-color-btn group w-full text-left px-3 py-2 rounded hover:bg-slate-800 transition-all flex items-center gap-3 border border-transparent hover:border-slate-700'
                          data-hex={color.hex}
                          title={`Insert ${color.name} (#${color.hex})`}
                        >
                          <span
                            class='w-4 h-4 rounded shadow-sm border border-black/20 shrink-0'
                            style={`background-color: #${color.hex}; box-shadow: 0 0 4px #${color.hex}40;`}
                          />
                          <span class='text-xs font-medium text-slate-400 group-hover:text-slate-200 truncate'>
                            {color.name}
                          </span>
                        </button>
                      ))}
                    </div>
                  </div>
                ))
              }
            </div>
          </div>
        </aside>
      </div>
    </main>

    <script>
      import { initColorizer } from './colorizer.js';
      document.addEventListener('DOMContentLoaded', initColorizer);
    </script>

    <style is:global>
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: rgba(30, 41, 59, 0.5);
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: rgba(71, 85, 105, 0.5);
        border-radius: 4px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: rgba(249, 115, 22, 0.5);
      }
    </style>
  </body>
</html>
