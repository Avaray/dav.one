---
interface TabItem {
  label: string;
  content: string;
}

interface Props {
  tabs: TabItem[];
  name: string;
}

const { tabs, name } = Astro.props;
---

<!-- src/components/Tabs.astro -->
<div class='tabs-container' data-tabs={name}>
  <div role='tablist' class='tabs-list'>
    {
      tabs.map((tab, index) => (
        <button
          role='tab'
          aria-selected={index === 0 ? 'true' : 'false'}
          aria-controls={`${name}-panel-${index}`}
          id={`${name}-tab-${index}`}
          class='tab-button'
          data-tab-index={index}
          type='button'
        >
          {tab.label}
        </button>
      ))
    }
  </div>

  <div class='tabs-panels'>
    {
      tabs.map((tab, index) => (
        <div
          role='tabpanel'
          id={`${name}-panel-${index}`}
          aria-labelledby={`${name}-tab-${index}`}
          class='tab-panel'
          class:list={[{ hidden: index !== 0 }]}
        >
          <pre>{tab.content}</pre>
        </div>
      ))
    }
  </div>
</div>

<style>
  .tabs-container {
    width: 100%;
  }

  .tabs-list {
    display: flex;
    gap: 0.25rem;
    border-bottom: 2px solid var(--color-primary);
    margin-bottom: 0;
  }

  .tab-button {
    background: transparent;
    border: none;
    padding: 0.75rem 1.25rem;
    cursor: pointer;
    font-weight: 500;
    color: var(--color-base-content);
    opacity: 0.6;
    border-bottom: 2px solid transparent;
    margin-bottom: -2px;
    transition: all 0.2s ease;
    font-size: 0.95rem;
  }

  .tab-button:hover {
    opacity: 0.8;
  }

  .tab-button[aria-selected='true'] {
    opacity: 1;
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
  }

  .tabs-panels {
    background: var(--color-code-bg);
    border-radius: 0 0 0.5rem 0.5rem;
  }

  .tab-panel {
    padding: 0;
  }

  .tab-panel.hidden {
    display: none;
  }

  .tab-panel pre {
    margin: 0;
    border-radius: 0 0 0.5rem 0.5rem;
  }
</style>

<script>
  function initTabs() {
    const tabContainers = document.querySelectorAll('[data-tabs]');

    tabContainers.forEach((container) => {
      const buttons = container.querySelectorAll('.tab-button');
      const panels = container.querySelectorAll('.tab-panel');

      buttons.forEach((button) => {
        button.addEventListener('click', () => {
          const tabIndex = parseInt(button.getAttribute('data-tab-index') || '0');

          // Deselect all buttons
          buttons.forEach((btn) => btn.setAttribute('aria-selected', 'false'));

          // Hide all panels
          panels.forEach((panel) => panel.classList.add('hidden'));

          // Select clicked button
          button.setAttribute('aria-selected', 'true');

          // Show corresponding panel
          panels[tabIndex].classList.remove('hidden');
        });
      });
    });
  }

  // Initialize on page load
  initTabs();

  // Re-initialize after view transitions
  document.addEventListener('astro:page-load', initTabs);
</script>
