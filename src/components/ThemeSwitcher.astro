<script>
  const customThemesList = ['light', 'dark', 'retro', 'cyberpunk', 'greenery'];

  function loadTheme() {
    const url = new URL(window.location.href);
    const theme = url.searchParams.get('theme');
    theme && setTheme(theme);
  }

  document.addEventListener('DOMContentLoaded', loadTheme);

  // Function to set theme and save it to localStorage
  function setTheme(theme?: string) {
    const htmlElement = document.documentElement;
    // This will set the theme to a random one if no theme is provided
    theme ??= customThemesList[Math.floor(Math.random() * customThemesList.length)];
    htmlElement.setAttribute('data-theme', theme);
    try {
      localStorage.setItem('theme', theme);
    } catch (error) {}
  }

  // Update URL with theme if parameter is present
  // I don't want to use theme param in URL by default
  function updateURLWithTheme(theme: string) {
    const url = new URL(window.location.href);
    if (url.searchParams.has('theme')) {
      url.searchParams.set('theme', theme);
      window.history.replaceState({}, '', url.href);
    }
  }

  // Change themes with CTRL + Arrow keys
  document.addEventListener('keydown', (event) => {
    if (event.ctrlKey) {
      const currentTheme = document.documentElement.getAttribute('data-theme') || '';
      const currentIndex = customThemesList.indexOf(currentTheme);
      if (event.key === 'ArrowLeft' || event.key === 'ArrowUp') {
        const previousTheme = customThemesList[currentIndex - 1] ?? customThemesList[customThemesList.length - 1];
        setTheme(previousTheme);
        updateURLWithTheme(previousTheme);
      } else if (event.key === 'ArrowRight' || event.key === 'ArrowDown') {
        const nextTheme = customThemesList[currentIndex + 1] ?? customThemesList[0];
        setTheme(nextTheme);
        updateURLWithTheme(nextTheme);
      }
    }
  });
</script>
